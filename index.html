<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Studio Multi-Diagrammes (UML, Mermaid, PlantUML)</title>
		<script src="mermaid.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
		<link rel="stylesheet" href="style.css" />
	</head>
	<body>
		<header>
			<span><strong>Diagram Studio</strong></span>
			<div id="status" style="font-size: 0.8em; opacity: 0.8">Mode: Mermaid</div>
		</header>

		<div class="main-container">
			<div class="editor-side">
				<div class="tabs">
					<button class="tab-btn active" onclick="setMode('mermaid')">Mermaid</button>
					<button class="tab-btn" onclick="setMode('plantuml')">PlantUML</button>
					<button class="tab-btn" onclick="setMode('draw')">Dessin Libre</button>
				</div>

				<textarea id="code-input" spellcheck="false" placeholder="Saisissez votre code ici..."></textarea>

				<div id="error-log-container" class="collapsible">
					<div id="error-log-header" onclick="toggleLog()">
						<span>Console & Erreurs</span>
						<span id="error-indicator" class="indicator hidden">!</span>
						<span class="toggle-icon">▼</span>
					</div>
					<div id="error-log-content" class="content">Prêt...</div>
				</div>

				<div class="controls">
					<button class="btn-download" onclick="downloadImage()">Télécharger l'image</button>
				</div>
			</div>

			<div class="preview-side" id="preview-side">
				<div id="draw-toolbar" style="display: none; padding: 10px; background: #f0f0f0; border-bottom: 1px solid #ccc;">
					<div style="display: flex; gap: 10px; align-items: center;">
						<button id="pencil-btn" class="tool-btn active">Crayon</button>
						<button id="eraser-btn" class="tool-btn">Gomme</button>
						<select id="shape-select">
							<option value="none">Forme</option>
							<option value="square">Carré</option>
							<option value="circle">Cercle</option>
							<option value="triangle">Triangle</option>
							<option value="ellipse">Ellipse</option>
							<option value="pentagon">Pentagone</option>
							<option value="hexagon">Hexagone</option>
							<option value="trapezoid">Trapèze</option>
						</select>
						<button id="clear-btn">Effacer tout</button>
					</div>
					<div id="color-palette" style="margin-top: 10px;">
						<button class="color-btn" data-color="#000000" style="background: #000; width: 20px; height: 20px; border: 1px solid #ccc;"></button>
						<button class="color-btn" data-color="#FF0000" style="background: #F00; width: 20px; height: 20px; border: 1px solid #ccc;"></button>
						<button class="color-btn" data-color="#00FF00" style="background: #0F0; width: 20px; height: 20px; border: 1px solid #ccc;"></button>
						<button class="color-btn" data-color="#0000FF" style="background: #00F; width: 20px; height: 20px; border: 1px solid #ccc;"></button>
						<button class="color-btn" data-color="#FFFF00" style="background: #FF0; width: 20px; height: 20px; border: 1px solid #ccc;"></button>
						<button class="color-btn" data-color="#FF00FF" style="background: #F0F; width: 20px; height: 20px; border: 1px solid #ccc;"></button>
						<button class="color-btn" data-color="#00FFFF" style="background: #0FF; width: 20px; height: 20px; border: 1px solid #ccc;"></button>
						<button class="color-btn" data-color="#FFA500" style="background: #FFA500; width: 20px; height: 20px; border: 1px solid #ccc;"></button>
						<button class="color-btn" data-color="#800080" style="background: #800080; width: 20px; height: 20px; border: 1px solid #ccc;"></button>
						<button class="color-btn" data-color="#FFC0CB" style="background: #FFC0CB; width: 20px; height: 20px; border: 1px solid #ccc;"></button>
					</div>
				</div>
				<div class="zoom-panel">
					<button onclick="changeZoom(-0.1)" title="Zoom arrière">−</button>
					<div class="zoom-slider-container">
						<input type="range" id="zoom-slider" min="0.2" max="3" step="0.1" value="1" oninput="updateZoom(this.value)" />
					</div>
					<button onclick="changeZoom(0.1)" title="Zoom avant">+</button>
					<span id="zoom-value">100%</span>
					<button onclick="resetView()" title="Réinitialiser la vue">Reset</button>
				</div>

				<div class="scene" id="scene">
					<div id="render-container">
						<div id="mermaid-output" class="mermaid"></div>
						<img id="plantuml-img" style="display: none" />
						<canvas id="free-draw-canvas" style="display: none; border: 1px solid #000"></canvas>
					</div>
				</div>
			</div>
		</div>

		<script src="script.js"></script>
	</body>
</html>
